from model.User import User
from model.Enums import UserRole
from utils.logger import logger


def show_info(user_id):
    """
    –í—ã–≤–æ–¥–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∫–æ–º–∞–Ω–¥–∞—Ö
    """
    try:
        user = User(user_id).get_data_from_db()

        # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
        if user.get_apartment() is None:
            return "‚ùå –í—ã –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã. –ß—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É –≤–≤–µ–¥–∏—Ç–µ /start"

        # –§–æ—Ä–º–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
        result = "üìã <b>–°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤–∞–º –∫–æ–º–∞–Ω–¥:</b>\n\n"

        # –ë–∞–∑–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –≤—Å–µ—Ö –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        result += "üë§ <b>–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:</b>\n"
        result += "‚Ä¢ /send - üìä –ü–µ—Ä–µ–¥–∞—Ç—å –ø–æ–∫–∞–∑–∞–Ω–∏—è —Å—á–µ—Ç—á–∏–∫–æ–≤\n"
        result += "‚Ä¢ /manager - üë®‚Äçüíº –û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ –ø—Ä–µ–¥—Å–µ–¥–∞—Ç–µ–ª—é\n"
        result += "‚Ä¢ /accountant - üßÆ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ –±—É—Ö–≥–∞–ª—Ç–µ—Ä—É\n"
        result += "‚Ä¢ /plumber - üíß –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É –Ω–∞ —Ä–∞–±–æ—Ç—É —Å–∞–Ω—Ç–µ—Ö–Ω–∏–∫–∞\n"
        result += "‚Ä¢ /electric - ‚ö° –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É –Ω–∞ —Ä–∞–±–æ—Ç—É —ç–ª–µ–∫—Ç—Ä–∏–∫–∞\n"
        result += "‚Ä¢ /account - üè† –ü–µ—Ä–µ—Ö–æ–¥ –≤ –ø—Ä–æ—Ñ–∏–ª—å –∫–≤–∞—Ä—Ç–∏—Ä—ã\n"
        result += "‚Ä¢ /info - ‚ÑπÔ∏è –ü–æ–∫–∞–∑–∞—Ç—å —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ\n\n"

        # –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
        has_staff_commands = False
        staff_commands = ""

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—É—é —Ä–æ–ª—å –∏ –¥–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã
        if user.has_role(UserRole.ADMIN):
            has_staff_commands = True
            staff_commands += "‚Ä¢ /backup - üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö\n"
            staff_commands += "‚Ä¢ /stats - üìà –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É\n"
            staff_commands += "‚Ä¢ /staff - üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–æ–º\n"

        if user.has_role(UserRole.MANAGER):
            has_staff_commands = True
            staff_commands += "‚Ä¢ /appeals - üì® –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ–±—Ä–∞—â–µ–Ω–∏—è\n"
            staff_commands += "‚Ä¢ /export - üìä –ü–æ–ª—É—á–∏—Ç—å Excel-—Ç–∞–±–ª–∏—Ü—É —Å –ø–æ–∫–∞–∑–∞–Ω–∏—è–º–∏ —Å—á–µ—Ç—á–∏–∫–æ–≤\n"

        if user.has_role(UserRole.ACCOUNTANT):
            has_staff_commands = True
            if '–ü–æ–ª—É—á–∏—Ç—å Excel-—Ç–∞–±–ª–∏—Ü—É —Å –ø–æ–∫–∞–∑–∞–Ω–∏—è–º–∏ —Å—á–µ—Ç—á–∏–∫–æ–≤' not in staff_commands:
                staff_commands += "‚Ä¢ /export - üìä –ü–æ–ª—É—á–∏—Ç—å Excel-—Ç–∞–±–ª–∏—Ü—É —Å –ø–æ–∫–∞–∑–∞–Ω–∏—è–º–∏ —Å—á–µ—Ç—á–∏–∫–æ–≤\n"

        # –ï—Å–ª–∏ –µ—Å—Ç—å –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, –¥–æ–±–∞–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
        if has_staff_commands:
            result += "üë®‚Äçüíº <b>–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:</b>\n" + staff_commands

        return result

    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –≤ info: {e}", exc_info=True)
        return "‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ."
